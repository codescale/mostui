doctype html
html
  head
    title MoStUi
  body
    div(id="addStat")
      form
        table(border="0")
          tr
            td(align="left") Host:
            td
              input(name="host", value="localhost")
          tr
            td(align="left") Port:
            td
              input(name="port", value="27017")
          tr
            td
            td
              input(type="submit" value="Add to statistics")
    div#charts
    
  
  link(rel='stylesheet', href='/stylesheets/style.css')
  link(rel='stylesheet', href='/stylesheets/dataTables.css')
  script(type='text/javascript', src="/js/jquery/jquery-2.1.3.min.js")
  script(type='text/javascript', src="/js/jquery/jquery.dataTables.min.js")
  script(type='text/javascript', src="/js/highchart/highcharts.js")
  script(type='text/javascript', src="/js/highchart/exporting.js")
  script(type='text/javascript', src="/js/highchart/theme.js")
  script.
    $(function () {

      // We excpect to have a cookie like
      // urls=j:{"url":[{"host":"10.12.45.17","port":"27017"}]}
      var cookies = document.cookie.split('=');
      
      if(cookies && cookies.length == 2) {
        var urls = decodeURIComponent(cookies[1]).split(':');
        // Skip the key of the array
        urls.shift();
        // And join the rest again
        urls = urls.join(':');
        // Parse the rest into JSON-object
        urls = JSON.parse(urls);
        // Load the Chart for each URL
        for(var i=0; i<urls.url.length; i++) {
          var url = urls.url[i];
          loadChart(url.host, url.port);
        }
      }
      
      $( "#addStat" ).submit(function( event ) {
        loadChart($('input[name=host]').val(), $('input[name=port]').val());
        event.preventDefault();
      });
      
      $( ".closeChart" ).click(function(event) {
        var chartId = event.toElement.parentElement.parentElement.id;
        $("#"+chartId).remove();
        // TODO: remove ip/port from cookies
        event.preventDefault();
      });
    });
  script(type='text/javascript', src="/js/loadCharts.js")